(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-61e70981"],{4266:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-row",{staticClass:"packing-list-body",attrs:{gutter:15}},[r("el-col",{staticStyle:{height:"100%"},attrs:{span:18}},[r("Table",{ref:"packingListTableRef",attrs:{broken:t.broken},on:{calculateTotalPrice:t.calculateTotalPrice}})],1),r("el-col",{staticStyle:{height:"100%","overflow-y":"auto"},attrs:{span:6}},[r("Tools",{attrs:{"is-table-valid":t.isTableValid,"total-price":t.totalPrice},on:{checkTable:function(e){return t.checkTableValididty()},closeNotification:t.closeNotification_,totalPriceChanged:t.totalPriceChanged,brokenState:t.changedBrokenState}})],1)],1)},a=[],n=r("5530"),c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{ref:"tblContainer",staticStyle:{height:"100%"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.getting_product,expression:"getting_product"}],staticStyle:{width:"100%","border-radius":"10px",overflow:"hidden",border:"1px solid #bbbbbb"},attrs:{"max-height":t.bodyHeight+"",size:"small",data:t.tableDataComputed,"show-summary":"",border:"","summary-method":t.jamiSumma}},[r("el-table-column",{attrs:{width:"150",label:"КАФЕЛНИ КОДИ",prop:"code",fixed:"left",align:"center"}}),r("el-table-column",{attrs:{width:"150",label:"ТУРИ",prop:"type_name",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.type_name+(e.row.broken?" - broken":""))+" ")]}}])}),r("el-table-column",{attrs:{width:"150",label:"ТОВАРНИ РАЗМЕРИ",prop:"size",align:"center"}}),r("el-table-column",{attrs:{width:"150",label:"ТОВАРНИ РАСМИ",prop:"photo",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-image",{staticStyle:{width:"30px",height:"30px"},attrs:{src:e.row.photo_path,fit:"scale-down"},on:{click:function(r){return t.openImg(e.row.photo_path)}}})]}}])}),2===t.order.action?r("el-table-column",{attrs:{width:"100",prop:"isReturning",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tooltip",{staticStyle:{"margin-right":"1em"},attrs:{effect:"dark",content:e.row.isReturning?"To Remove":"To add",placement:"left"}},[r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":""},model:{value:e.row.isReturning,callback:function(r){t.$set(e.row,"isReturning",r)},expression:"scope.row.isReturning"}})],1)]}}],null,!1,438109691)},[r("template",{slot:"header"},[r("span",{staticStyle:{"font-weight":"bold"}},[t._v("+ / -")])])],2):t._e(),r("el-table-column",{attrs:{width:"300",label:"УМУМИЙ МИҚДОРНИ ЎЛЧОВ БИРЛИГИ",align:"center"}},[r("el-table-column",{attrs:{width:"150",label:"УМУМИЙ (м2)",align:"center",prop:"packTotalArea"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-input",{attrs:{size:"small",type:"number",value:e.row.packTotalArea},on:{input:function(r){return t.areaIsChanging(r,e.row)}}})]}}])}),r("el-table-column",{attrs:{width:"150",label:"УМУМИЙ (ДОНАСИ)",prop:"item_num",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"two-fields"},[r("el-input",{attrs:{size:"small",value:e.row.item_num},on:{input:function(r){return t.item_numIsChanging(r,e.row)}}})],1)]}}])})],1),r("el-table-column",{attrs:{width:"155",align:"center"}},[r("template",{slot:"header"},[r("span",[t._v("ТОВАРНИ УМУМИЙ")]),r("br"),r("span",[t._v("ПОЧКАСИНИНГ")]),r("br"),r("span",[t._v("(МИҚДОРИ)")]),r("br")]),r("el-table-column",{attrs:{width:"178",align:"center",prop:"pack_num"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("div",{staticClass:"two-fields"},[r("div",{staticClass:"two-fields"},[r("el-input",{attrs:{size:"small",value:e.row.pack_num},on:{input:function(r){return t.pack_numIsChanging(r,e.row)}}})],1),r("div",{staticClass:"two-fields"},[r("el-input",{attrs:{size:"small",value:e.row.over_pack_num},on:{input:function(r){return t.over_pack_numIsChanging(r,e.row)}}})],1)])]}}])},[r("template",{slot:"header"},[r("span",[t._v("ТОВАРНИ УМУМИЙ")]),r("br"),r("span",[t._v("ДОНАСИНИ")]),r("br"),r("span",[t._v("(МИҚДОРИ)")]),r("br")])],2)],2),r("el-table-column",{attrs:{width:"100",prop:"base_price",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tooltip",{staticStyle:{"margin-right":"1em"},attrs:{effect:"dark",content:e.row.base_priceBy?"Донаси бўйича":"м2 бўйича",placement:"left"}},[r("el-switch",{attrs:{value:e.row.base_priceBy,"active-color":"#13ce66","inactive-color":""},on:{change:function(r){return t.calcPriceprice_byChanged(r,e.row)}}})],1)]}}])},[r("template",{slot:"header"},[r("span",[t._v("м2 / ДОНА")])])],2),r("el-table-column",{attrs:{width:"120",prop:"base_price",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",[t._v(t._s(e.row.base_price))])]}}])},[r("template",{slot:"header"},[r("span",[t._v("КАССА")]),r("br"),r("span",[t._v("НАРХИ")])])],2),r("el-table-column",{attrs:{width:"130",prop:"sum_kassa",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.sum_kassa.toFixed(2))+" ")]}}])},[r("template",{slot:"header"},[r("span",[t._v("МАХСУЛОТНИНГ")]),r("br"),r("span",[t._v("УМУМИЙ")]),r("br"),r("span",[t._v("КАССА")]),r("br"),r("span",[t._v("НАРХИ")])])],2),r("el-table-column",{attrs:{width:"130",prop:"base_price_changed",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-input",{attrs:{size:"small",type:"number",value:e.row.base_price_changed},on:{input:function(r){return t.base_priceIsChanging(r,e.row)}}})]}}])},[r("template",{slot:"header"},[r("span",[t._v("ЎЗГАРГАН")]),r("br"),r("span",[t._v("КАССА")]),r("br"),r("span",[t._v("НАРХИ")])])],2),r("el-table-column",{attrs:{width:"130",prop:"sum",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(e.row.sum.toFixed(2))+" ")]}}])},[r("template",{slot:"header"},[r("span",[t._v("СКИДКА")]),r("br"),r("span",[t._v("НАРХИ")])])],2),r("el-table-column",{attrs:{width:"150",label:"ТОВАРНИ УМУМИЙ КИЛОГРАММИ",prop:"weight",align:"center"}},[r("template",{slot:"header"},[r("span",[t._v("ТОВАРНИ")]),r("br"),r("span",[t._v("УМУМИЙ")]),r("br"),r("span",[t._v("КИЛОГРАММИ")])])],2),r("el-table-column",{attrs:{label:"1-ТА ПОЧКАДИГИ КОЛИЧЕСТВАНИ ЎЛЧОВ БИРЛИГИ",align:"center"}},[r("el-table-column",{attrs:{width:"160",label:"ПОЧКАСИДИГИ (м2)",align:"center",prop:"area_of_one_packet"}}),r("el-table-column",{attrs:{width:"140",label:"1-ДОНАСИНИ (м2)",prop:"area_of_an_item",align:"center"}}),r("el-table-column",{attrs:{align:"center",prop:"number_of_items",width:"140",label:"УМУМИЙ ДОНАСИ"}}),r("el-table-column",{attrs:{width:"160",label:"ПОЧКАСИДИГИ (КГ)",align:"center",prop:"wight_of_one_packet"}}),r("el-table-column",{attrs:{width:"140",label:"1-ДОНАСИНИ  (КГ)",align:"center",prop:"weight_of_an_item"}})],1)],1),r("el-dialog",{attrs:{top:"1%",title:"",visible:t.showImageDilog,"append-to-body":"",width:"40%"},on:{"update:visible":function(e){t.showImageDilog=e}}},[r("el-image",{staticStyle:{width:"100%",height:"90%"},attrs:{src:t.imageUrl,fit:"scale-down"}})],1)],1)},i=[],s=(r("d3b7"),r("159b"),r("d81d"),r("a9e3"),r("b680"),r("2f62")),l=(r("4de4"),{props:{broken:{type:Boolean,default:!1}},data:function(){return{showImageDilog:!1,imageUrl:"",maxHeight:600,newArea:"",currentNotification:null,currentProduct:{},brokenPropotionArr:[],totalPrice:0}},computed:Object(n["a"])(Object(n["a"])({},Object(s["e"])("others/products",["product"])),{},{tableDataComputed:function(){var t=this;return this.product.product_types?this.product.product_types:this.product.product_types?this.product.product_types.filter((function(e){return e.broken===t.broken})):[]}})}),u=r("2909"),d=(r("7db0"),r("b65f"),r("b0c0"),r("99af"),{methods:{areaIsChanging:function(t,e){if(this.currentProduct=this.tableDataComputed.find((function(t){return t._id===e._id})),t){t=parseFloat(t),this.currentProduct.packTotalArea=this.truncateToDecimals(t,4);var r=this.truncateToDecimals(t/this.currentProduct.area_of_an_item,4),o=this.truncateToDecimals(parseFloat(r-parseInt(r)),4);r=Math.ceil(r),o<=1e-4&&t?(this.currentProduct.item_num=r,this.currentProduct.pack_num=parseInt(r/this.currentProduct.number_of_items),this.currentProduct.over_pack_num=parseInt(r%this.currentProduct.number_of_items),this.currentProduct.sum=parseInt(this.currentProduct.base_price*t),this.currentProduct.weight=this.truncateToDecimals(this.currentProduct.item_num*this.currentProduct.weight_of_an_item,2),this.calcPrice(),this.calculateTotalPrice()):0===t?(this.currentProduct.item_num=0,this.currentProduct.pack_num=0,this.currentProduct.over_pack_num=0,this.currentProduct.sum=0,this.calculateTotalPrice(),this.currentProduct.weight=0):(this.currentProduct.item_num="",this.currentProduct.pack_num="",this.currentProduct.over_pack_num="",this.currentProduct.sum=0,this.calculateTotalPrice(),this.currentProduct.weight="")}else this.currentProduct.packTotalArea=t},item_numIsChanging:function(t,e){this.currentProduct=this.tableDataComputed.find((function(t){return t._id===e._id})),t?(this.currentProduct.item_num=parseInt(t),this.currentProduct.packTotalArea=this.truncateToDecimals(parseFloat(this.currentProduct.item_num*this.currentProduct.area_of_an_item),4),this.currentProduct.pack_num=parseInt(this.currentProduct.item_num/this.currentProduct.number_of_items),this.currentProduct.over_pack_num=parseInt(this.currentProduct.item_num%this.currentProduct.number_of_items),this.calcPrice(),this.currentProduct.weight=(this.currentProduct.item_num*this.currentProduct.weight_of_an_item).toFixed(2),this.calculateTotalPrice()):(this.currentProduct.over_pack_num="",this.currentProduct.item_num="",this.currentProduct.pack_num="",this.currentProduct.packTotalArea="",this.currentProduct.sum=0,this.calculateTotalPrice(),this.currentProduct.weight="")},pack_numIsChanging:function(t,e){this.currentProduct=this.tableDataComputed.find((function(t){return t._id===e._id})),t?(this.currentProduct.pack_num=parseInt(t),this.currentProduct.item_num=parseInt(this.currentProduct.pack_num*this.currentProduct.number_of_items+this.currentProduct.over_pack_num),this.currentProduct.over_pack_num=""===this.currentProduct.over_pack_num?0:this.currentProduct.over_pack_num,this.currentProduct.packTotalArea=parseFloat((this.currentProduct.item_num*this.currentProduct.area_of_an_item).toFixed(4)),this.calcPrice(),this.currentProduct.weight=(this.currentProduct.item_num*this.currentProduct.weight_of_an_item).toFixed(2),this.calculateTotalPrice()):(this.currentProduct.pack_num=t,this.currentProduct.item_num="",this.currentProduct.item_num="",this.currentProduct.packTotalArea="",this.currentProduct.sum=0,this.calculateTotalPrice(),this.currentProduct.weight="")},over_pack_numIsChanging:function(t,e){this.currentProduct=this.tableDataComputed.find((function(t){return t._id===e._id})),t?(this.currentProduct.item_num=parseInt(this.currentProduct.pack_num*this.currentProduct.number_of_items+parseInt(t)),this.currentProduct.over_pack_num=parseInt(t)>this.currentProduct.number_of_items?parseInt(t)%this.currentProduct.number_of_items:parseInt(t),this.currentProduct.packTotalArea=parseFloat((this.currentProduct.item_num*this.currentProduct.area_of_an_item).toFixed(4)),this.currentProduct.weight=(this.currentProduct.item_num*this.currentProduct.weight_of_an_item).toFixed(2),this.calcPrice(),this.calculateTotalPrice()):(this.currentProduct.over_pack_num=t,this.currentProduct.item_num="",this.currentProduct.packTotalArea="",this.currentProduct.sum=0,this.calculateTotalPrice(),this.currentProduct.weight="")},base_priceIsChanging:function(t,e){this.currentProduct=this.tableDataComputed.find((function(t){return t._id===e._id})),t?(this.currentProduct.base_price_changed=parseFloat(t),this.currentProduct.sum=parseFloat((this.currentProduct.base_price_changed*this.currentProduct.packTotalArea).toFixed(4)),this.calculateTotalPrice()):(this.currentProduct.base_price_changed=t,this.currentProduct.sum=0)},calculatebase_prices:function(t){if(t){t=""===t?0:parseFloat(t+"");var e=this.tableDataComputed.reduce((function(t,e){return t+(""===e.sum?0:parseFloat(e.sum))}),0),r=[];this.tableDataComputed.forEach((function(t){r.push(t.sum/e)}));for(var o=0;o<r.length;o++){var a=this.tableDataComputed[o];a.sum=t*r[o],a.price_by&&a.item_num?a.base_price_changed=a.sum/a.item_num:!a.price_by&&a.packTotalArea?a.base_price_changed=parseFloat((a.sum/a.packTotalArea).toFixed(4)):0!==a.price_by&&0!==a.packTotalArea&&this.$notify({message:"Number of item is unknown! or Area is unknown!",type:"error",duration:2300})}}},calcPrice:function(){var t=""===this.currentProduct.item_num?0:parseFloat(this.currentProduct.item_num),e=""===this.currentProduct.packTotalArea?0:parseFloat(this.currentProduct.packTotalArea);this.currentProduct.sum=this.currentProduct.base_price_changed*(this.currentProduct.price_by?t:e),this.currentProduct.sum_kassa=this.currentProduct.base_price*(this.currentProduct.price_by?t:e)},calcPriceprice_byChanged:function(t,e){this.currentProduct=this.tableDataComputed.find((function(t){return t._id===e._id})),this.currentProduct.base_priceBy=t,this.calcPrice(),this.calculateTotalPrice()},truncateToDecimals:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,r=Math.pow(10,e);return Math.trunc(t*r)/r},calculateTotalPrice:function(){this.$emit("calculateTotalPrice",this.truncateToDecimals(this.tableDataComputed.reduce((function(t,e){return t+(""===e.sum?0:parseFloat(e.sum))}),0),4))},closeNotification:function(){this.currentNotification&&this.currentNotification.close()},checkPropotion:function(){var t=this,e=this.tableDataComputed.reduce((function(t,e){return t+(""===e.packTotalArea?0:parseFloat(e.packTotalArea))}),0),r={name:"",bad_percentage:0,good_percentage:0};this.brokenPropotionArr=[],this.tableDataComputed.forEach((function(o){r.name=o.type_name,r.good_percentage=o.proportion,r.bad_percentage=0===e?0:t.truncateToDecimals(""===o.packTotalArea?0:parseFloat(o.packTotalArea)/e*100),t.brokenPropotionArr.push(r),r={name:"",bad_percentage:0,good_percentage:0}}));var o=this.$createElement;this.currentNotification&&this.currentNotification.close(),this.currentNotification=this.$notify({type:"error",title:"Proportion error",dangerouslyUseHTMLString:!0,message:o("table",{class:"notificationTable"},[o("tr",null,[o("th",{style:{width:"35%"}},"Name"),o("th",{style:{width:"35%"}},"Should be"),o("th",{style:{width:"30%"}},"Now")])].concat(Object(u["a"])(function(){var e=[];return t.brokenPropotionArr.forEach((function(t){e.push(o("tr",null,function(){return[o("td",null,t.name),o("td",null,t.good_percentage.toFixed(2)),o("td",null,t.bad_percentage)]}()))})),e}()))),duration:0})},checkTableIsValid:function(){var t=!0;return this.tableDataComputed.forEach((function(e){""===e.packTotalArea&&(t=!1),""===e.item_num&&(t=!1),""===e.pack_num&&(t=!1),""===e.over_pack_num&&(t=!1),""===e.base_price_changed&&(t=!1)})),t}}}),h={components:{},mixins:[l,d],data:function(){return{baseApi:"http://165.232.153.58:3001/",bodyHeight:300}},computed:Object(n["a"])(Object(n["a"])({},Object(s["e"])("others/products",["getting_product"])),Object(s["e"])("others/products",["order"])),mounted:function(){var t=this;setTimeout((function(){t.bodyHeight=t.$refs.tblContainer.clientHeight,console.log(t.$refs.tblContainer.clientHeight)}),300),window.addEventListener("resize",(function(e){t.bodyHeight=t.$refs.tblContainer.clientHeight}))},beforeDestroy:function(){this.SET_PRODUCT([])},methods:Object(n["a"])(Object(n["a"])({},Object(s["d"])("others/products",["SET_PRODUCT"])),{},{openImg:function(t){this.showImageDilog=!0,this.imageUrl=t},jamiSumma:function(t){var e=t.columns,r=t.data,o=[];return e.forEach((function(t,e){if(0===e&&(o[e]="Жами"),"packTotalArea"===t.property||"item_num"===t.property||"sum"===t.property||"sum_kassa"===t.property){var a=r.map((function(e){return Number(e[t.property])}));if(a.every((function(t){return isNaN(t)})))o[e]="";else{var n=a.reduce((function(t,e){var r=Number(e);return isNaN(r)?t:t+e}),0);o[e]=parseFloat(n.toFixed(4))}}})),this.$nextTick((function(){})),o}})},p=h,m=(r("4b92"),r("2877")),_=Object(m["a"])(p,c,i,!1,null,null,null),b=_.exports,f=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"tools-wrapper"},[r("p",[r("span",[t._v("Инвойс №:")]),r("br"),t._v(" "+t._s(t.order.order_name))]),r("el-form",{ref:"toolBarFormRef",staticStyle:{width:"100%"},attrs:{model:t.toolBarForm,rules:t.rules}},[r("el-form-item",{attrs:{prop:"belongsTo",label:"Партнер"}},[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Партнер номи | дўкони",loading:t.gettingOthers},on:{change:t.belongsChanging},model:{value:t.toolBarForm.belongsTo,callback:function(e){t.$set(t.toolBarForm,"belongsTo",e)},expression:"toolBarForm.belongsTo"}},t._l(t.others,(function(e,o){return r("el-option",{key:o,staticStyle:{display:"flex","justify-content":"space-between"},attrs:{value:e._id,label:e.firstName+" "+e.lastName+" | "+e.shop}},[r("span",[t._v(t._s(e.firstName+" "+e.lastName))]),r("span",[t._v(t._s(e.shop))])])})),1)],1),r("el-form-item",{attrs:{prop:"currentProduct",label:"Махсулот номи"}},[r("el-select",{staticStyle:{width:"100%","background-color":"transparent"},attrs:{placeholder:"Махсулотни танланг",loading:t.gettingProducts},on:{change:t.getProducts},model:{value:t.toolBarForm.currentProduct,callback:function(e){t.$set(t.toolBarForm,"currentProduct",e)},expression:"toolBarForm.currentProduct"}},t._l(t.products,(function(t,e){return r("el-option",{key:e,staticStyle:{"background-color":"transparent"},attrs:{label:t.product_name,value:t._id}})})),1)],1),r("el-form-item",[r("el-col",{staticStyle:{padding:"0"},attrs:{span:14}},[r("el-form-item",{attrs:{prop:"batch_",label:"Партияси"}},[r("el-input",{attrs:{type:"number",placeholder:"Партияси"},on:{change:t.setBatch},model:{value:t.toolBarForm.batch_,callback:function(e){t.$set(t.toolBarForm,"batch_",e)},expression:"toolBarForm.batch_"}})],1)],1),r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{prop:"isSample",label:"_"}},[r("el-checkbox",{staticStyle:{width:"100%"},on:{change:t.sampleStateChanged},model:{value:t.toolBarForm.isSample,callback:function(e){t.$set(t.toolBarForm,"isSample",e)},expression:"toolBarForm.isSample"}},[t._v("Образец")])],1)],1)],1),t.toolBarForm.isSample?t._e():r("el-form-item",{attrs:{prop:"currentcustomer"}},[r("el-select",{staticClass:"tools-wrapper-item",staticStyle:{width:"100%"},attrs:{placeholder:"Клиентни танланг"},on:{change:t.customerChanged},model:{value:t.toolBarForm.currentcustomer,callback:function(e){t.$set(t.toolBarForm,"currentcustomer",e)},expression:"toolBarForm.currentcustomer"}},t._l(t.customers,(function(t,e){return r("el-option",{key:e,attrs:{label:t.firstName+" "+t.lastName,value:t._id}})})),1)],1),t.toolBarForm.isSample?r("el-form-item",{attrs:{prop:"currentShop"}},[r("el-select",{staticClass:"tools-wrapper-item",staticStyle:{width:"100%"},attrs:{placeholder:"Қайси дўкон учун"},on:{change:t.shopChanged},model:{value:t.toolBarForm.currentShop,callback:function(e){t.$set(t.toolBarForm,"currentShop",e)},expression:"toolBarForm.currentShop"}},t._l(t.shops,(function(t,e){return r("el-option",{key:e,attrs:{label:t.name,value:t._id}})})),1)],1):t._e(),t.toolBarForm.isSample?t._e():r("el-form-item",{attrs:{prop:"currentStatus"}},[r("el-select",{staticClass:"tools-wrapper-item",staticStyle:{width:"100%"},attrs:{placeholder:"Жараённи танланг"},on:{change:t.procedureChanged},model:{value:t.toolBarForm.currentStatus,callback:function(e){t.$set(t.toolBarForm,"currentStatus",e)},expression:"toolBarForm.currentStatus"}},[r("el-option",{attrs:{label:"Сотиб олиш",value:1}}),r("el-option",{attrs:{label:"Бартер (Алмаштириш)",value:2}}),r("el-option",{attrs:{label:"Қайтариш",value:3}})],1)],1),t.toolBarForm.isSample?t._e():r("el-form-item",{attrs:{prop:"currentDriver"}},[r("el-select",{staticClass:"tools-wrapper-item",staticStyle:{width:"100%"},attrs:{placeholder:"Шоферни танланг"},on:{change:t.currentDriverChanged},model:{value:t.toolBarForm.currentDriver,callback:function(e){t.$set(t.toolBarForm,"currentDriver",e)},expression:"toolBarForm.currentDriver"}},t._l(t.drivers,(function(t,e){return r("el-option",{key:e,attrs:{label:t.firstName+" "+t.lastName,value:t._id}})})),1)],1),t.toolBarForm.isSample?t._e():r("el-form-item",{attrs:{prop:"costOfUpload"}},[r("el-input",{staticClass:"tools-wrapper-item",attrs:{type:"number",placeholder:"Погрузка суммаси"},on:{change:t.costOfUploadChanging},model:{value:t.toolBarForm.costOfUpload,callback:function(e){t.$set(t.toolBarForm,"costOfUpload",e)},expression:"toolBarForm.costOfUpload"}}),r("p",[t._v("Пагрузка: "+t._s(t.toThousandFilter(Math.ceil(t.total_Area_for_invoice*t.toolBarForm.costOfUpload))))])],1),r("el-form-item",{attrs:{prop:"totalPrice",label:"Скидка нархи (охирги нархи)"}},[r("el-input",{staticClass:"tools-wrapper-item",attrs:{value:t.totalPrice,type:"number",placeholder:"Скидка нархи (охирги нархи)"},on:{input:t.changebase_price}})],1),t.toolBarForm.isSample?t._e():r("el-form-item",{attrs:{label:"Қазргами ?",prop:"isDebt"}},[r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":""},on:{change:t.setIsDebt},model:{value:t.toolBarForm.isDebt,callback:function(e){t.$set(t.toolBarForm,"isDebt",e)},expression:"toolBarForm.isDebt"}})],1),t.toolBarForm.isDebt?r("el-form-item",{attrs:{label:"Қазрни қайтариш санаси",prop:"debtDate"}},[r("el-date-picker",{staticStyle:{"margin-bottom":"1em"},attrs:{type:"date",format:"yyyy-MM-dd","value-format":"timestamp",placeholder:"Қазрни қайтариш санаси"},on:{change:t.setReturnDebtDate},model:{value:t.toolBarForm.debtDate,callback:function(e){t.$set(t.toolBarForm,"debtDate",e)},expression:"toolBarForm.debtDate"}})],1):t._e(),t.toolBarForm.isDebt?r("el-form-item",{attrs:{label:"Изоҳ",prop:"debtDescription"}},[r("el-input",{staticStyle:{"margin-bottom":"1em"},attrs:{type:"textarea",rows:"4"},on:{change:t.setDebtDescription},model:{value:t.toolBarForm.debtDescription,callback:function(e){t.$set(t.toolBarForm,"debtDescription",e)},expression:"toolBarForm.debtDescription"}})],1):t._e()],1),r("div",{staticClass:"order-action-btn"},[r("el-button",{attrs:{type:"primary",disabled:t.order_saving,loading:t.order_saving},on:{click:function(e){return t.validateOrder()}}},[t._v("Сохранить")]),r("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.reset_all()}}},[t._v("Отмена")])],1)],1)},g=[],v=r("1da1"),P=(r("96cf"),r("caad"),r("2532"),r("b775")),k=r("5c96"),T={data:function(){var t=this;return{action_of_customer:-1,toolBarForm:{belongsTo:"",isSample:!1,currentProduct:"",withBorken:!1,currentcustomer:"",currentStatus:"",currentDriver:"",costOfUpload:"",totalPrice:this.totalPrice,isDebt:!1,currentShop:"",debtDate:"",batch_:"",debtDescription:""},rules:{batch_:[{trigger:"change",validator:function(t,e,r){e?r():r(new Error("Enter batch"))}}],currentShop:[{trigger:"change",validator:function(e,r,o){t.toolBarForm.isSample?r?o():o(new Error("Select shop")):o()}}],debtDate:[{trigger:"change",validator:function(e,r,o){t.toolBarForm.isDebt?r?o():o(new Error("Select debt date")):o()}}],batch:[{trigger:"change",validator:function(e,r,o){t.toolBarForm.isDebt?r?o():o(new Error("Input batch")):o()}}],totalPrice:[{trigger:"change",validator:function(e,r,o){t.toolBarForm.isSample||""!==r?o():o(new Error("Enter price"))}}],currentDriver:[{trigger:"change",validator:function(e,r,o){t.toolBarForm.isSample||r?o():o(new Error("Select driver"))}}],belongsTo:[{trigger:"change",validator:function(e,r,o){t.toolBarForm.isSample||r?o():o(new Error("Select other"))}}],currentStatus:[{trigger:"change",validator:function(e,r,o){t.toolBarForm.isSample||r?o():o(new Error("Select action"))}}],currentProduct:[{trigger:"change",validator:function(e,r,o){t.toolBarForm.isSample||r?o():o(new Error("Select product"))}}],currentcustomer:[{trigger:"change",validator:function(e,r,o){t.toolBarForm.isSample||r?o():o(new Error("Select customer"))}}]}}},methods:{getLastActionOfCustomer:function(){var t=this;Object(P["a"])({url:"/orders/what_is_last_action_of_customer",params:{id:this.toolBarForm.currentcustomer}}).then((function(e){console.log("Current order",e),t.action_of_customer=null===e.data?-1:e.data.action})).catch((function(t){console.error(t)}))}}},w=r("8975"),y={mixins:[T],props:{totalPrice:{type:[Number,String],default:0},isTableValid:{type:[Boolean],default:!1}},data:function(){return{gettingOthers:!1,gettingProducts:!1,order_saving:!1,batches:[],others:[]}},computed:Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])({},Object(s["e"])("others/products",["products"])),Object(s["e"])("others/products",["product","order","total_Area_for_invoice"])),Object(s["e"])("shops",["shops"])),{},{drivers:function(){return this.$store.state.drivers.tableData},customers:function(){return this.$store.state.customers.tableData}}),mounted:function(){var t=this;this.getOrderCount(),this.GET_CUSTOMERS(),this.GET_DRIVERS(),this.GET_SHOPS(),Object(P["a"])({url:"/products/get-batches",method:"GET"}).then((function(e){t.batches=e.data,console.log(t.batches)})).catch((function(t){console.log(t)})),Object(P["a"])({url:"/others/list",method:"GET"}).then((function(e){t.gettingOthers=!1,t.others=e.data})).catch((function(e){t.gettingOthers=!1,Object(k["Message"])({duration:2e3,message:e.response.data,type:"error"}),console.error(e)}))},methods:Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])(Object(n["a"])({toThousandFilter:function(t){return Object(w["toThousandFilter"])(t)}},Object(s["b"])("others/products",["GET_PRODUCT_TYPES","GET_PRODUCT_BY_TYPE_ID","SAVE_ORDER"])),Object(s["b"])("customers",["GET_CUSTOMERS"])),Object(s["b"])("shops",["GET_SHOPS"])),Object(s["b"])("drivers",["GET_DRIVERS"])),Object(s["d"])("others/products",["SET_ORDER","PREPARE_ORDER"])),Object(s["b"])("others/products",["GET_PRODUCTS","GET_PRODUCT"])),{},{belongsChanging:function(t){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.SET_ORDER({key:"other_id",value:t}),e.gettingProducts=!0,r.next=4,e.GET_PRODUCTS({other_id:t});case 4:e.gettingProducts=!1;case 5:case"end":return r.stop()}}),r)})))()},setBatch:function(t){this.SET_ORDER({key:"batch_",value:parseInt(t)})},getOrderCount:function(){var t=this;Object(P["a"])({url:"/others/get-order-count-for-today"}).then((function(e){console.log("orders",e.data);var r=new Date;console.log("ALFAM-".concat(e.data[0].count+1,"-").concat(r.getDate(),"/").concat(r.getMonth()+1,"/").concat(r.getFullYear())),t.SET_ORDER({key:"order_name",value:"ALFAM-".concat(e.data[0].count+1,"-").concat(r.getDate(),"/").concat(r.getMonth()+1,"/").concat(r.getFullYear())})})).catch((function(t){console.log("orders",t)}))},checkTableIsValidToSave:function(){this.$emit("checkTable")},validateOrder:function(){var t=this;this.checkTableIsValidToSave(),setTimeout((function(){t.$refs.toolBarFormRef.validate((function(e){if(!e)return!1;t.isTableValid?t.saveOrder():t.$notify({message:"Check table, there should not be empty, make them 0",type:"error",duration:0})}))}),120)},saveOrder:function(){var t=this;this.order_saving=!0,this.PREPARE_ORDER(),setTimeout((function(){t.SAVE_ORDER().then((function(){t.order_saving=!1,Object(k["Message"])({message:"Order successfully saved",type:"success",duration:3e3}),t.reset_all(),t.$emit("closeNotification"),t.getOrderCount()})).catch((function(e){t.order_saving=!1,Object(k["Message"])({message:e.response.data,type:"error",duration:3e3})}))}),200)},setIsDebt:function(t){this.SET_ORDER({key:"is_debt",value:t})},getProducts:function(t){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=e.products.find((function(e){return e._id.includes(t)})),e.SET_ORDER({key:"product",value:{title:o.product_name,product_id:o._id}}),r.next=4,e.GET_PRODUCT({_id:t});case 4:case"end":return r.stop()}}),r)})))()},changebase_price:function(t){this.$emit("totalPriceChanged",t),console.log("totalPriceChanged",t),this.toolBarForm.totalPrice=t,this.SET_ORDER({key:"last_sum",val:t})},brokenStateChanged:function(t){this.$emit("brokenState",t),this.SET_ORDER({key:"includes_brokens",value:t})},sampleStateChanged:function(t){this.SET_ORDER({key:"isSample",value:t})},procedureChanged:function(t){this.SET_ORDER({key:"action",value:t})},setReturnDebtDate:function(t){this.SET_ORDER({key:"date_of_return_debt",value:t})},setDebtDescription:function(t){this.SET_ORDER({key:"description_of_debt",value:t})},costOfUploadChanging:function(t){this.SET_ORDER({key:"upload_cost",value:parseFloat(t)})},currentDriverChanged:function(t){this.SET_ORDER({key:"driver",value:t})},customerChanged:function(t){this.SET_ORDER({key:"customer",value:t}),this.getLastActionOfCustomer()},shopChanged:function(t){this.SET_ORDER({key:"shop",value:t})},reset_all:function(){this.toolBarForm.belongsTo="",this.toolBarForm.withBorken=!1,this.toolBarForm.currentProduct="",this.toolBarForm.currentStatus="",this.toolBarForm.currentcustomer="",this.toolBarForm.costOfUpload="",this.order_saving=!1,this.toolBarForm.currentDriver="",this.toolBarForm.debtDescription="",this.toolBarForm.debtDate="",this.toolBarForm.isDebt=!1,this.changebase_price(0),this.$refs.toolBarFormRef.resetFields()}})},S=y,D=(r("628a"),Object(m["a"])(S,f,g,!1,null,null,null)),F=D.exports,O={name:"SkladPackingList",components:{Table:b,Tools:F},data:function(){return{totalPrice:0,broken:!1,isTableValid:!1}},methods:Object(n["a"])(Object(n["a"])({},Object(s["d"])("others/products",["SET_ORDER"])),{},{checkTableValididty:function(){console.log("this.$refs.packingListTableRef.checkTableIsValid()",this.$refs.packingListTableRef.checkTableIsValid()),this.isTableValid=this.$refs.packingListTableRef.checkTableIsValid()},closeNotification_:function(){this.$refs.packingListTableRef.closeNotification()},calculateTotalPrice:function(t){this.totalPrice=t,this.SET_ORDER({key:"last_sum",value:t})},totalPriceChanged:function(t){this.totalPrice=t,this.SET_ORDER({key:"last_sum",value:t}),this.$refs.packingListTableRef.calculatebase_prices(t)},changedBrokenState:function(t){var e=this;this.broken=t,setTimeout((function(){e.$refs.packingListTableRef.calculateTotalPrice()}),200)}})},E=O,R=(r("c925"),Object(m["a"])(E,o,a,!1,null,null,null));e["default"]=R.exports},"4b92":function(t,e,r){"use strict";r("6f12")},"628a":function(t,e,r){"use strict";r("df5c")},6682:function(t,e,r){},"6f12":function(t,e,r){},"7db0":function(t,e,r){"use strict";var o=r("23e7"),a=r("b727").find,n=r("44d2"),c=r("ae40"),i="find",s=!0,l=c(i);i in[]&&Array(1)[i]((function(){s=!1})),o({target:"Array",proto:!0,forced:s||!l},{find:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}}),n(i)},b65f:function(t,e,r){var o=r("23e7"),a=Math.ceil,n=Math.floor;o({target:"Math",stat:!0},{trunc:function(t){return(t>0?n:a)(t)}})},c925:function(t,e,r){"use strict";r("6682")},df5c:function(t,e,r){}}]);